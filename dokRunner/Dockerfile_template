# Base image â€“ change if you prefer 18.04 / 22.04 / etc.
FROM ubuntu:20.04

ENV DEBIAN_FRONTEND=noninteractive

# ---- Base tools ----
RUN apt-get update && apt-get install -y --no-install-recommends \
    python3 \
    python3-pip \
    python3-venv \
    git \
    vim \
    less \
    ca-certificates \
    bash-completion \
    # GUI / X11 basic libs for many apps (adjust as needed)
    libx11-6 \
    libxext6 \
    libxrender1 \
    libxrandr2 \
    libgtk-3-0 \
    # (optional) some GStreamer basics if you use it a lot
    gstreamer1.0-tools \
    gstreamer1.0-plugins-base \
    gstreamer1.0-plugins-good \
    gstreamer1.0-plugins-bad \
    && rm -rf /var/lib/apt/lists/*

# ---- Create non-root user (so you can match UID=1000 etc.) ----
ARG USERNAME=dev
ARG UID=1000
ARG GID=1000

RUN groupadd -g ${GID} ${USERNAME} && \
    useradd -m -u ${UID} -g ${GID} -s /bin/bash ${USERNAME}

# Allow passwordless sudo if you want it (optional):
RUN apt-get update && apt-get install -y sudo && \
    echo "${USERNAME} ALL=(ALL) NOPASSWD:ALL" > /etc/sudoers.d/90-${USERNAME} && \
    chmod 0440 /etc/sudoers.d/90-${USERNAME} && \
    rm -rf /var/lib/apt/lists/*

USER ${USERNAME}
WORKDIR /home/${USERNAME}/workspace

# ---- Python deps (optional) ----
# If you want per-project Python deps baked in, create requirements.txt next to
# this Dockerfile and uncomment the next two lines:
# COPY requirements.txt /tmp/requirements.txt
# RUN pip3 install --no-cache-dir -r /tmp/requirements.txt && rm /tmp/requirements.txt

# Default command: interactive shell. The run script will override this.
CMD ["/bin/bash"]

