# buildAndorid

export LANG=C
export LC_ALL=C
export LC_COLLATE=C

## rspi3
* https://github.com/tab-pi/platform_manifest

mkdir /andrPI/ ; cd /andrPI/
repo init -u https://github.com/tab-pi/platform_manifest -b nougat
repo sync

### Build Kernel
cd kernel/rpi
ARCH=arm scripts/kconfig/merge_config.sh arch/arm/configs/bcm2709_defconfig android/configs/android-base.cfg android/configs/android-recommended.cfg
ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- make zImage
ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- make dtbs

### Build Android source

. build/envsetup.sh
lunch rpi3-eng
make ramdisk systemimage
m 

### deploy

```
== Prepare sd card
 Partitions of the card should be set-up like followings.
  p1 256MB for BOOT : Do fdisk : W95 FAT32(LBA) & Bootable, mkfs.vfat
  p2 640MB for /system : Do fdisk, new primary partition
  p3 128MB for /vendor : Do fdisk, new primary partition
  p4 remainings for /data : Do fdisk, mkfs.ext4
 Set volume label for /data partition as userdata
  : use -L option of mkfs.ext4, e2label command, or -n option of mkfs.vfat

== Write system & vendor partition
  $ cd out/target/product/rpi3
  $ sudo dd if=system.img of=/dev/<p2> bs=1M
  $ sudo dd if=vendor.img of=/dev/<p3> bs=1M

== Copy kernel & ramdisk to BOOT partition
  device/brcm/rpi3/boot/* to p1:/
  kernel/rpi/arch/arm/boot/zImage to p1:/
  kernel/rpi/arch/arm/boot/dts/bcm2710-rpi-3-b.dtb to p1:/
  kernel/rpi/arch/arm/boot/dts/overlays/vc4-kms-v3d.dtbo to p1:/overlays/vc4-kms-v3d.dtbo
  out/target/product/rpi3/ramdisk.img to p1:/

== HDMI_MODE : If DVI monitor does not work, try followings for p1:/config.txt
  hdmi_group=2
  hdmi_mode=85

```


* src#2: https://github.com/android-rpi/local_manifests/tree/android10


## googlePhone

mkdir /andrGO/ ; cd /andrGO/

* XXXX: https://source.android.com/setup/start/build-numbers#source-code-tags-and-builds

```
			XXXX
			=================
OPM7.181205.001 	android-8.1.0_r52 	Oreo 	Nexus 5X, Nexus 6P 	2018-12-05


```

repo init -u https://android.googlesource.com/platform/manifest -b XXXX
repo sync

## complete build for the emulator, with all debugging enabled

. build/envsetup.sh
lunch aosp_arm-eng
m

## googlePhone target

* YYYY: https://source.android.com/setup/build/running#selecting-device-build

```
			YYYY
			=====================
Pixel 3a 	sargo 	aosp_sargo-userdebug
Nexus 6P 	angler 	aosp_angler-userdebug

```
. build/envsetup.sh
lunch YYYY
m


